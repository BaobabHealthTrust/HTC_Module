<!DOCTYPE=html>
<html>
	<head>
		<title>Current Visit</title>
		<script>
			  function voiding(node) {             
                                                                                  
						if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari  
								xmlhttp=new XMLHttpRequest();                                             
							}else{// code for IE6, IE5                                                  
								xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");                           
							}                                                                           
							xmlhttp.onreadystatechange=function() {                                     
								if (xmlhttp.readyState==4 && xmlhttp.status==200) {                       
								  var results = xmlhttp.responseText;
								  location.reload();                              
								  }                                                                     
								}                                                                         
							                                                                         
							xmlhttp.open("GET","/encounters/void/" + node, true); 
							xmlhttp.send(); 
				}
		</script>
		<style>
			.arrow-right {
				width: 0; 
				height: 0; 
				border-top: 180px solid transparent; 
				border-left: 40px solid #ccc; 
				border-bottom: 180px solid transparent;
				cursor: pointer;
			}
			
			.arrow-left {
				width: 0; 
				height: 0; 
				border-top: 180px solid transparent; 
				border-right: 40px solid #ccc; 
				border-bottom: 180px solid transparent;
				cursor: pointer;
			}
			
			.arrow-left:hover{
				border-right: 40px solid #999; 
			}
			
			.arrow-right:hover{
				border-left: 40px solid #999; 
			}

.blue {
    background-color: #a7cfdf;
    background-image: linear-gradient(to bottom, #a7cfdf, #23538a);
    border: 1px solid #7eb9d0;
    border-radius: 3px;
    color: #ffffff;
    display: inline-block;
    font-family: arial,helvetica,sans-serif;
    font-size: 28px;
    font-weight: bold;
    padding: 10px;
    text-decoration: none;
    text-shadow: -1px -1px 0 rgba(0, 0, 0, 0.3);
}
.button {
    border-radius: 10px !important;
    cursor: pointer;
    font-size: 0.5em;
    margin: 3px;
    min-height: 60px;
    min-width: 70px;
    padding: 15px;
}
button {
    border-radius: 10px !important;
    cursor: pointer;
    font-size: 0.5em;
    margin: 3px;
    min-height: 50px;
    min-width: 50px;
    padding: 15px;
}

		</style>
	</head>
	<body style="margin: 10px; overflow: auto; font-family: Helvetica;">
		<div style="display: table; width: 100%; border: 1px solid #eee; height: 99%;">
			<div style="display: table-row;">
				<div style="display: table-cell; vertical-align: middle; padding-left: 10px; width: 100px;">

					<div class="arrow-left" onmousedown="window.parent.clickPrevious()">
					</div>

				</div>
				<div style="display: table-cell; vertical-align: top;border: 3px black solid;border-radius: 0px 0px 25px 25px;hieght:200px;overflow: auto;">
					
					<div style=" margin: auto; margin-bottom: 40px; width: 100%; vertical-align: middle; ">
						<label style="color: #5679c1; font-weight: normal; font-size: 24px;">Today's Visit Details</label>
					</div>
					
					<div style="display: table; margin: auto;">
						<div style="display: table-row;">
							<div style="display: table-cell; padding:15px;width:40%;">
								<label style="color: #5679c1; font-weight: bold; font-size: 16px;">Current Client's States Summary</label>
								
								<div style="display: table; border: 1px solid #5679c1; font-size: 18px;">
									<div style="display: table-row;">
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1; font-weight: bold; padding: 5px; border-right: 1px solid #5679c1;">
											First State Time
										</div>
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1; padding: 5px; width: 50%;">
												<%= @firststatus.encounter_datetime.strftime("%I :%M") rescue "NaN" %>
										</div> 
									</div>
									<div style="display: table-row;">
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1; font-weight: bold; padding: 5px; border-right: 1px solid #5679c1;">
											Current State
										</div> 
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1; padding: 5px;">
											<%= @status.name rescue "NaN"%>
										</div> 
									</div>
									<div style="display: table-row;">
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1; font-weight: bold; padding: 5px; border-right: 1px solid #5679c1;">
											Current State Start
										</div> 
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1; padding: 5px;">
											<%= @status.encounter_datetime.strftime("%I :%M") rescue "NaN" %>
										</div> 
									</div>
									
									<!-- div style="display: table-row;">
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1;  font-weight: bold; padding: 5px; border-right: 1px solid #5679c1;">
											Final State Time
										</div>
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1;  padding: 5px;">
											<%= @finalstatus.encounter_datetime.strftime("%I : %M") rescue "NaN" %>
										</div> 
									</div -->
									
									<div style="display: table-row;">
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1;  font-weight: bold; padding: 5px; border-right: 1px solid #5679c1;">
											&nbsp;
										</div> 
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1;  padding: 5px;">
											&nbsp;
										</div> 
									</div>
									<div style="display: table-row;">
										<div style="display: table-cell; font-weight: bold; padding: 5px; border-right: 1px solid #5679c1;">
											&nbsp;
										</div> 
										<div style="display: table-cell; padding: 5px;">
											&nbsp;
										</div> 
									</div>
								</div>
							</div>
							
							<div style="display: table-cell;width:60%;">
								<label style="color: #5679c1; font-weight: bold; font-size: 16px;">Current Client's States Log</label>
								
								<div style="display: table; border: 1px solid #5679c1; font-size: 15px;vertical-align: top;">
                                                                      <% @encounters.each{|encounter| %>
									<div style="display: table-row;">
										<div style="width: 10%;vertical-align: top;display: table-cell; border-bottom: 1px dotted #5679c1; padding: 5px; border-right: 1px solid #5679c1;">
											<%= encounter.encounter_datetime.strftime("%I : %M")  %>
										</div> 
										<div style="vertical-align: top;display: table-cell; border-bottom: 1px dotted #5679c1; padding: 5px;">
											 <b><%= encounter.name   %>:</b> <br />
												<%= encounter.to_s.html_safe   %>
												<% answers = CounselingAnswer.where("encounter_id = ?", encounter.encounter_id)
													 (answers || []).each { |answer| %>
														<%= answer.to_s.html_safe %>
												<% } %>
										</div> 
										<div style="display: table-cell; border-bottom: 1px dotted #5679c1; padding: 5px; width: 250px;">
										<button style="float: right;margin: 3px; font-size: 20px; height: 60px;"
										class="button blue" onmousedown="voiding('<%= encounter.encounter_id %>')">Void</button>
									 </div>
									</div>
									<% } %>
								</div>
							</div>
						</div>
					</div>
					
				</div>
				<div style="display: table-cell; vertical-align: middle; padding-right: 10px; width: 100px; text-align: right;">
					
					<div class="arrow-right" style="float: right;" onmousedown="window.parent.clickNext()">					
					</div>
					
				</div>
			</div>
		</div>
	</body>
</html>		
			}
