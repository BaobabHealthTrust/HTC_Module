<html>
  <head>
    <script>
      var cancelDestination = "/clients/<%= @client.id %>";
      function __$(id){
        return document.getElementById(id);
      }

      function processMultipleElements(){
        testReasons = document.getElementById('textFortest_reason').value;
        accessionNumber = document.getElementById('textForaccession_number').value;
        console.log(testReasons)//Without this, testReasons variable is null. Remove at owners risk
        form = document.createElement('form');
        document.getElementsByTagName('body')[0].appendChild(form);
        form.action ='/early_infant_diagnosis';
        form.method='POST'
        createInput(form, 'hidden', 'test_reasons', testReasons)
        createInput(form, 'hidden', 'accession_number', accessionNumber)
        createInput(form, 'hidden', 'authenticity_token', '<%= form_authenticity_token() %>')
        createInput(form, 'hidden', 'id', '<%= params[:id] %>')
        form.submit();
      }

      function createInput(form, type, name, value){
        input = document.createElement('input');
        input.type = type
        input.value = value
        input.name = name
        form.appendChild(input)
      }
      
    </script>
  </head>
  <body>
    <form action='/early_infant_diagnosis' method='post' id="mybody">
      <input type="hidden" value="<%= form_authenticity_token() %>" name="authenticity_token"/>
      <input type='hidden' name='id' value=<%= @client.id %> />

      <input type='hidden' id="test_reasons" name='test_reasons' />

      <fieldset >
        <legend>Early Infant Diagnosis</legend>
        <!-------                         -->
        <label for="accession_number"> Accession Number</label>
        <input type="text" id="accession_number" name="accession_number" />
        <!---                     -->
        <label for="test_reason"> Reason for Test (EID)</label>
        <select   id="test_reason" name="test_reason[]" multiple="true">
          <option></option>
          <option value="HIV Exposed Infant">HIV Exposed Infant</option>
          <option value="HIV Exposed Infant wit PSHD">HIV Exposed Infant wit PSHD</option>
          <option value="Unknown exposure with symptoms">Unknown exposure with symptoms</option>
        </select>
        <br />

      </fieldset>
      <%= submit_tag "Finish" %>
    </form>
  </body>
  <script>
    function setAttributes(){
      btnNext.onclick = function(){
        
      }
    
      btnNext.onmousedown = function(){
        processMultipleElements();
      }
    }
    window.setTimeout("setAttributes();", 350);
  </script>
</html>
